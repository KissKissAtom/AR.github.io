<!DOCTYPE html>
<html>
<head>
  <title>AR VERS_5</title>
      <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
  <script type="text/javascript" src="https://raw.githack.com/AR-js-org/AR.js/3.4.5/three.js/build/ar-threex-location-only.js"></script>
  <script type="text/javascript" src="https://raw.githack.com/AR-js-org/AR.js/3.4.5/aframe/build/aframe-ar.js"></script>
      <style>
      #debug {
        position: fixed;
        z-index: 10000;
        background-color: #fff;
        padding: 10px;
        top: 0;
        left: 0;
        display: block;
      }
    </style>
</head>
  <body style="margin: 0; overflow: hidden;">
    <div id="debug"></div>
  <a-scene   
    renderer="logarithmicDepthBuffer: true;"
    embedded
    arjs="trackingMethod: best; sourceType: webcam;debugUIEnabled: false;"
    vr-mode-ui="enabled: false" 
    renderer="antialias: true; alpha: true"
  >
    <a-camera gps-camera rotation-reader></a-camera>

    <!-- Tous les points GPS, chaque <a-box> a maintenant la classe "ar-point" -->
    <!--<a-box class="ar-point" color="red" gps-new-entity-place="latitude: 45.77622542056777; longitude: 3.085409693938061" look-at="[gps-camera]" depth="10" height="10" width="10"></a-box>
    <a-box class="ar-point" color="blue" gps-new-entity-place="latitude: 45.77648297170218; longitude: 3.0853850759625296" look-at="[gps-camera]" depth="10" height="10" width="10"></a-box>-->
  
   <a-box
        material="color: red"
        gps-new-entity-place="latitude: 45.88629156123663; longitude: 3.5902984357269085;"
        position 0 0 0
        scale="1 1 1"
      ></a-box>
      <a-text
        id="text"
        value=""
        look-at="[gps-camera]"
        scale="30 30 30"
        position="0 55 0"
        gps-new-entity-place="latitude: 45.88639909121938; longitude: 3.5904151118190564;"
      ></a-text>
  </a-scene>

  <!-- Script de filtrage par distance -->
  <script>
  window.addEventListener('load', () => {
    const text = document.getElementById('text');
    const debug = document.getElementById('debug');

    text.addEventListener('gps-entity-place-update-position', (event) => {
      const distance = event.detail.distance;

      // Affichage dans le débogueur
      debug.textContent = `Distance : ${distance.toFixed(2)} m`;

      // Affichage dans l'entité texte
      text.setAttribute('value', `${distance.toFixed(1)} m left`);
    });
  });
  </script>
</body>
</html>
